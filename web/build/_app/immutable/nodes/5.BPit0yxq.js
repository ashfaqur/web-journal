import"../chunks/DsnmJJEf.js";import{y as T,f as x,t as H,a as _,d as D,r as b,p as P,s as v,b as y,u as z,c as G,e as C,h as g,g as w,i as r,j as k}from"../chunks/BNTUZOXl.js";import{e as j,i as A}from"../chunks/DjYGhFoA.js";import{s as I,d as N}from"../chunks/sj2ceDET.js";import{i as L}from"../chunks/CxFcOU2T.js";import{p as M}from"../chunks/BMRxCDaR.js";import{P as S}from"../chunks/CeYoBlxV.js";import{P as E}from"../chunks/CjmMPHb7.js";import{p as R,e as W,g as B}from"../chunks/x3GgUWrs.js";import{P as F,s as U}from"../chunks/B0Yvt91p.js";function X(s,e,t){var a=s==null?"":""+s;return a===""?null:a}function q(s,e,t,a,o,d){var c=s.__className;if(T||c!==t||c===void 0){var l=X(t);(!T||l!==s.getAttribute("class"))&&(l==null?s.removeAttribute("class"):s.className=l),s.__className=t}return d}var J=x('<div class="container flex min-w-full items-center justify-center bg-green-400 px-6 py-1"><h3 class="text-2xl"> </h3></div>');function K(s,e){var t=J(),a=D(t),o=D(a,!0);b(a),b(t),H(()=>I(o,e.title)),_(s,t)}var Q=x("<button> </button>");function Y(s,e){var t=Q();t.__click=function(...o){e.onclick?.apply(this,o)};var a=D(t);b(t),H(()=>{q(t,1,`btn border-green-400 hover:bg-green-500 ${e.selected?"bg-green-500":"bg-green-300"} `),I(a,`${e.text??""} Days`)}),_(s,t)}N(["click"]);var Z=x('<div class="mb-1 mt-1 min-w-full rounded bg-yellow-200 px-4 py-2 text-center"><p class="text-yellow-900"> </p></div>');function O(s,e){var t=Z(),a=D(t),o=D(a,!0);b(a),b(t),H(()=>I(o,e.text)),_(s,t)}var $=x("<!> <!> <!>",1);function tt(s,e){P(e,!0),M(e,"displayXAxisGap",3,1);let t=v(!1),a=v(y([])),o=v(y([])),d=v(y([])),c=v(y(new Map));const l={None:"gray",Complete:"green",Incomplete:"orange"};async function h(){const n=await R(e.days);console.log("Last days data loaded:",n),g(a,n.dates,!0),g(o,n.points,!0),g(d,n.states,!0),g(c,n.stateCounts,!0),g(t,n.fallback,!0)}z(()=>{const n=performance.now();h();const V=performance.now();console.debug(`Time to fetch last days data: ${V-n} ms`)});var p=$(),m=G(p);{var i=n=>{O(n,{text:"Showing mock data due to fetch error"})};L(m,n=>{r(t)&&n(i)})}var u=w(m,2);{let n=k(()=>`Points earned over the last ${e.days} Days`);S(u,{get title(){return r(n)},xaxis:"Date",yaxis:"Points",get x(){return r(a)},get y(){return r(o)},get states(){return r(d)},get stateColors(){return l}})}var f=w(u,2);E(f,{title:"Percentage of days having entries",get chart(){return r(c)},get stateColors(){return l},get fallback(){return r(t)}}),_(s,p),C()}var et=x('<div class="w-full"></div>');function at(s,e){P(e,!0);let t=M(e,"plotId",3,"heatmap");const a=[[0,"rgb(148, 7, 7)"],[.5,"rgb(235, 242, 237)"],[1,"rgb(15, 163, 2)"]],o=55,d=35,c=100,l=-10,h=10;let p=k(()=>e.xValues.length>10?d:o),m=k(()=>[{x:e.xValues,y:e.yValues,z:e.zValues,type:"heatmap",colorscale:a,zmin:l,zmax:h,showscale:!1}]),i=k(()=>({title:{text:e.title,font:{size:20}},annotations:[],xaxis:{ticks:"",side:"top"},yaxis:{ticks:"",ticksuffix:" "},height:e.yValues.length*r(p)+c,autosize:!0,plot_bgcolor:"#000000"}));const u={responsive:!0};z(()=>{F.newPlot(t(),r(m),r(i),u)});var f=et();H(()=>U(f,"id",t())),_(s,f),C()}var st=x("<!> <!>",1);function rt(s,e){P(e,!0);let t=v(!1),a=v(y([])),o=v(y([])),d=v(y([]));async function c(){const i=await W(e.days),u=i.data.reverse();if(g(t,i.isFallback,!0),g(o,u.map(f=>f.name.split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" ")),!0),u.length>0){const f=Object.keys(u[0].data).sort((n,V)=>n.localeCompare(V));f.length>7?g(a,f,!0):g(a,B(f),!0),g(d,u.map(n=>f.map(V=>n.data[V]??0)),!0)}}z(()=>{const i=performance.now();c();const u=performance.now();console.debug(`Time to fetch habit data: ${u-i} ms`)});var l=st(),h=G(l);{var p=i=>{O(i,{text:"Showing mock data due to fetch error"})};L(h,i=>{r(t)&&i(p)})}var m=w(h,2);at(m,{title:"Habits",get xValues(){return r(a)},get yValues(){return r(o)},get zValues(){return r(d)}}),_(s,l),C()}var nt=x('<div class="container flex min-w-full flex-col items-center"><!> <div class="btn-group mt-1 space-x-1"></div> <!> <!></div>');function ht(s){const e="Last Days",t=[7,30];let a=v(y(t[0]));var o=nt(),d=D(o);K(d,{title:e});var c=w(d,2);j(c,21,()=>t,A,(p,m)=>{{let i=k(()=>r(m).toString()),u=k(()=>r(a)===r(m));Y(p,{get text(){return r(i)},get selected(){return r(u)},onclick:()=>g(a,r(m),!0)})}}),b(c);var l=w(c,2);tt(l,{get days(){return r(a)}});var h=w(l,2);rt(h,{get days(){return r(a)}}),b(o),_(s,o)}export{ht as component};
