import{t as k,a as w}from"../chunks/disclose-version.Dw_O2kA8.js";import"../chunks/legacy.COm9Ut0I.js";import{p as G,b as g,c as r,g as p,e as R,t as P,d as N,r as t,a as j,af as A,f as z}from"../chunks/runtime.D8p1NF4P.js";import{i as B}from"../chunks/if.CyD_aiLQ.js";import{e as E,i as H}from"../chunks/each.m9ykutg7.js";import{i as J}from"../chunks/lifecycle.DYy9BHbZ.js";import{o as K}from"../chunks/index-client.v0nErfSU.js";import{c as Q}from"../chunks/api.Cnw3Ux_m.js";import{s as _}from"../chunks/render.WCGL6h7A.js";import{a as S}from"../chunks/plotly.min.wzrcMcfF.js";import{L as W}from"../chunks/LineChart.DS4whf9E.js";var Y=k('<div class="flex flex-col items-center pb-5 pt-5 text-center"><h1 class="mb-4 text-3xl font-bold"> </h1> <div class="mb-4 flex flex-row items-center gap-2"><progress class="progress progress-primary h-9 w-72" max="100"></progress> <div class="text-sm font-bold text-black"></div></div> <!> <div class="mt-2 text-lg text-gray-600"><p> </p> <p> </p></div></div>');function Z(y,a){var F;G(a,!0);let o=a.progress.data;console.log("Progress component received data:",o);const m=`progress-plot-${a.progress.title.replace(/[\s-]+/g,"").toLowerCase()}`,l=((F=o[o.length-1])==null?void 0:F.totalProgress)||0;console.log(`Rendering progress component for "${a.progress.title}" with latest progress: ${l}%`);const f=o.slice(-90),e=o.slice(-30);let i=0,x=1/0;if(e.length>0){const c=e.at(-1).totalProgress;let u=c,L=1;for(let h=e.length-2;h>=0;(h-=1)+1){const M=e[h].totalProgress;if(M<=u)u=M,L=e.length-h;else break}i=(c-u)/L,x=i>0?Math.ceil((100-c)/i):1/0}else console.log("No progress data available");var d=Y(),v=r(d),s=r(v,!0);t(v);var n=g(v,2),C=r(n);S(C,l);var O=g(C,2);O.textContent=`${l??""}%`,t(n);var D=g(n,2),U=R(()=>f.map(c=>c.date)),V=R(()=>f.map(c=>c.totalProgress));W(D,{title:"Progress over days",plotId:m,xaxis:"Date",yaxis:"Progression (%)",displayXAxisGap:5,get x(){return p(U)},get y(){return p(V)},yRange:[0,100]});var I=g(D,2),b=r(I),X=r(b);P(()=>_(X,`Current Rate: ${i.toFixed(2)??""}%`)),t(b);var T=g(b,2),q=r(T);P(()=>_(q,`Days to Complete: ${Math.ceil(x)??""}`)),t(T),t(I),t(d),P(()=>_(s,a.progress.title)),w(y,d),N()}var $=k('<div class="rounded bg-yellow-200 px-4 py-2 text-center"><p class="text-yellow-900">Displaying fallback data due to fetch error.</p></div>'),ee=k('<section><div class="container flex min-w-full items-center justify-center bg-green-400 px-6 py-1"><h3 class="text-2xl"></h3></div></section> <!> <section></section>',1);function de(y,a){G(a,!1);const o="Progress";let m=A([]),l=A(!1);K(async()=>{const s=await Q();j(m,s.data),j(l,s.isFallback),console.log("Progress data loaded:",p(m),"Is fallback:",p(l))}),J();var f=ee(),e=z(f),i=r(e),x=r(i);x.textContent=o,t(i),t(e);var d=g(e,2);B(d,()=>p(l),s=>{var n=$();w(s,n)});var v=g(d,2);E(v,5,()=>p(m),H,(s,n)=>{Z(s,{get progress(){return p(n)}})}),t(v),w(y,f),N()}export{de as component};
